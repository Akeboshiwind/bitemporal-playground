# 2 – Bitemporal Visualizer Initial Implementation

Related issue(s): Task 2
Source of truth for task status: the external issue tracker.

---

## Task Summary

Transform the starter app into a bitemporal visualizer with:
- A main canvas panel showing a grid with valid time (x-axis) and system time (y-axis)
- Bitemporal events rendered as colored rectangles
- A side panel with controls (starting with just a title)
- Preserved Ably presence counter in bottom right

---

## Current Understanding

**Bitemporal events have:**
- `_valid_from`: float - start of valid time range
- `_valid_to`: float - end of valid time range
- `_system_from`: float - when the event was recorded in the system
- `color`: RGB tuple - display color

**Rendering requirements:**
1. Background layer: Grid lines, x-axis (valid time), y-axis (system time)
2. Events layer: Rectangles drawn back-to-front by `_system_from` value
3. Foreground layer: Placeholder for future overlays

**Layout:**
- Left side panel with title "Bitemporal Visualizer"
- Main canvas area
- Presence counter stays in bottom right corner

---

## What We Need to Do

- [x] Create task file
- [x] Update app.cljs with new layout (side panel + main canvas)
- [x] Implement canvas module with multi-pass rendering
- [x] Add sample bitemporal events for testing
- [x] Verify presence counter remains functional (kept in bottom right, fixed positioning)

---

## Important Learnings

- Using Squint (ClojureScript dialect) with Reagami for UI
- Canvas 2D API will be used for rendering
- Events sorted by _system_from for correct z-ordering

---

## Important Files / Components

- `src/app/app.cljs` – Main app entry point, contains layout with side panel + canvas
- `src/app/canvas.cljs` – Canvas rendering module (grid, axes, events)
- `src/app/ably.cljs` – Ably presence (unchanged)
- `src/index.html` – HTML entry point

---

## Reasoning Notes

Initial task setup based on user requirements.
