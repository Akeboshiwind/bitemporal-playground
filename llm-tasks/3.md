# 3 – Edit event properties (color, etc.)

Related issue(s): GH-3
Source of truth for task status: the external issue tracker.

---

## Task Summary

Allow users to edit properties of events, starting with color. The key challenge is designing a UI that lets users edit properties while maintaining visibility of other events for context.

---

## Current Understanding

* Events have properties: `_valid_from`, `_valid_to`, `_system_from`, and `color` (RGB array)
* Users need to see surrounding events when editing to understand context
* Previous spike: modal floating to left of event - rejected because it obscured other events
* Multi-select exists, so batch editing is supported

Chosen approach: **Right-click context menu**
* Opens at mouse position like a native context menu
* Shows 5 preset color swatches + color picker
* Works with single events or multi-selected events

---

## What We Need to Do

**Completed:**
1. ~~Discuss and decide on UI approach~~ - Right-click context menu chosen
2. ~~Implement context menu with color editing~~ - Done

**Future extensions (not in scope for initial implementation):**
* Add more editable properties (name/label, notes, etc.)
* Add delete option to context menu
* Add duplicate option

---

## Important Learnings

* The sidebar already exists (`side-panel` component) with a grid toggle
* Events can be selected individually or multi-selected
* Canvas rendering happens via `render-canvas!` function
* State is persisted to localStorage
* `context-menu` atom tracks menu state separately from main state
* Color utilities: `rgb->css`, `rgb->hex`, `hex->rgb` for conversions

---

## Important Files / Components

* `src/app/app.cljs` – Main app state, event handlers, UI components
  * `context-menu` atom - tracks menu open state, position, target indices
  * `color-menu` component - renders the context menu
  * `on-context-menu` - right-click handler
  * `set-event-colors!` - applies color to target events
* `src/app/canvas.cljs` – Canvas rendering (events, grid, selection)

---

## Reasoning Notes

Initial document creation for task 3.

Chose right-click context menu over sidebar panel, inline popup, or double-click approaches because:
* Doesn't obscure canvas content at all (key requirement)
* Familiar UX pattern
* Naturally works with multi-select (targets all selected events)
